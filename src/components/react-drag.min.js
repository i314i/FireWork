!function(t,e){"function"==typeof define&&define.amd?define(["React"],e):"object"==typeof exports?module.exports=e(require("react/addons")):t.ReactDrag=e(t.React)}(this,function(t){"use strict";function e(){for(var t="",n=0;n<arguments.length;n++){var a=arguments[n];if(a){var s=typeof a;if("string"===s||"number"===s)t+=" "+a;else if(Array.isArray(a))t+=" "+e.apply(null,a);else if("object"===s)for(var r in a)a.hasOwnProperty(r)&&a[r]&&(t+=" "+r)}}return t.substr(1)}function n(t){return{position:{top:t.state.pageY,left:t.state.pageX}}}function a(t){return"both"===t.props.axis||"y"===t.props.axis}function s(t){return"both"===t.props.axis||"x"===t.props.axis}function r(t){return"function"==typeof t||"[object Function]"===Object.prototype.toString.call(t)}function o(t,e){for(var n=0,a=t.length,s=null;a>n;n+=1)if(s=t[n],e.apply(e,[s,n,t]))return s}function i(t,e){var n=o(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"],function(e){return r(t[e])});return t[n].call(t,e)}function p(t){var e=t.touches&&t.touches[0]||t;return{pageX:e.pageX,pageY:e.pageY}}function h(t,e,n,a){if(n){"string"!=typeof n&&"parent"!==n.toLowerCase()&&"object"!=typeof n&&console.warn('Bound should either "parent" or an object');var s=a.parentNode,r=n.top||0,o=n.left||0,i=n.right||s.offsetWidth,p=n.bottom||s.offsetHeight;t=Math.min(t,i-a.offsetWidth),e=Math.min(e,p-a.offsetHeight),t=Math.max(o,t),e=Math.max(r,e)}return{pageX:t,pageY:e}}function u(t,e,n){t&&(t.attachEvent?t.attachEvent("on"+e,n):t.addEventListener?t.addEventListener(e,n,!0):t["on"+e]=n)}function g(t,e,n){t&&(t.detachEvent?t.detachEvent("on"+e,n):t.removeEventListener?t.removeEventListener(e,n,!0):t["on"+e]=null)}var c=function(){},d=e;if("undefined"==typeof window)var f=!1;else{var f="ontouchstart"in window||"onmsgesturechange"in window;try{document.createEvent("TouchEvent")}catch(l){f=!1}}var y=function(){var t={touch:{start:"touchstart",move:"touchmove",end:"touchend"},mouse:{start:"mousedown",move:"mousemove",end:"mouseup"}};return t[f?"touch":"mouse"]}(),v=t.createClass({displayName:"Draggable",propTypes:{axis:t.PropTypes.oneOf(["both","x","y"]),handle:t.PropTypes.string,cancel:t.PropTypes.string,grid:t.PropTypes.arrayOf(t.PropTypes.number),start:t.PropTypes.object,onStart:t.PropTypes.func,onDrag:t.PropTypes.func,onStop:t.PropTypes.func,onMouseDown:t.PropTypes.func,bound:t.PropTypes.any},componentWillUnmount:function(){g(window,y.move,this.handleDrag),g(window,y.end,this.handleDragEnd)},getDefaultProps:function(){return{axis:"both",handle:null,cancel:null,grid:null,bound:!1,start:{x:0,y:0},onStart:c,onDrag:c,onStop:c,onMouseDown:c}},getInitialState:function(){return{dragging:!1,startX:0,startY:0,offsetX:0,offsetY:0,pageX:this.props.start.x,pageY:this.props.start.y}},handleDragStart:function(t){this.props.onMouseDown(t);var e=this.getDOMNode();if(!(this.props.handle&&!i(t.target,this.props.handle)||this.props.cancel&&i(t.target,this.props.cancel))){var a=p(t);this.setState({dragging:!0,offsetX:parseInt(a.pageX,10),offsetY:parseInt(a.pageY,10),startX:parseInt(e.style.left,10)||0,startY:parseInt(e.style.top,10)||0}),this.props.onStart(t,n(this)),u(window,y.move,this.handleDrag),u(window,y.end,this.handleDragEnd)}},handleDragEnd:function(t){this.state.dragging&&(this.setState({dragging:!1}),this.props.onStop(t,n(this)),g(window,y.move,this.handleDrag),g(window,y.end,this.handleDragEnd))},handleDrag:function(t){var e=p(t),a=this.state.startX+(e.pageX-this.state.offsetX),s=this.state.startY+(e.pageY-this.state.offsetY),r=h(a,s,this.props.bound,this.getDOMNode());if(a=r.pageX,s=r.pageY,Array.isArray(this.props.grid)){var o=a<parseInt(this.state.pageX,10)?-1:1,i=s<parseInt(this.state.pageY,10)?-1:1;a=Math.abs(a-parseInt(this.state.pageX,10))>=this.props.grid[0]?parseInt(this.state.pageX,10)+this.props.grid[0]*o:this.state.pageX,s=Math.abs(s-parseInt(this.state.pageY,10))>=this.props.grid[1]?parseInt(this.state.pageY,10)+this.props.grid[1]*i:this.state.pageY}this.setState({pageX:a,pageY:s}),this.props.onDrag(t,n(this)),t.preventDefault()},render:function(){var e={top:a(this)?this.state.pageY:this.state.startY,left:s(this)?this.state.pageX:this.state.startX},n=d({"react-drag":!0,"react-drag-dragging":this.state.dragging});return t.addons.cloneWithProps(t.Children.only(this.props.children),{style:e,className:n,onMouseDown:this.handleDragStart,onTouchStart:function(t){return t.preventDefault(),this.handleDragStart.apply(this,arguments)}.bind(this),onMouseUp:this.handleDragEnd,onTouchEnd:this.handleDragEnd})}});return v});